{{- $codeOverrides := .Values.app.codeOverrides }}
{{- $overrideFiles := default (list) $codeOverrides.files }}
{{- if and $codeOverrides.enabled (gt (len $overrideFiles) 0) }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "kserve-models-web-app.fullname" . }}-overrides
  namespace: {{ include "kserve-models-web-app.namespace" . }}
  labels:
    {{- include "kserve-models-web-app.labels" . | nindent 4 }}
    app.kubernetes.io/component: code-overrides
  annotations:
    oremus-labs.com/source: raw-deployment-support
binaryData:
{{- range $file := $overrideFiles }}
  {{ $file.key }}: {{ $.Files.Get $file.source | b64enc }}
{{- end }}
{{- end }}
